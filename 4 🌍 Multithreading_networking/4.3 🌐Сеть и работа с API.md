# ü§ù –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö API

## **1. –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å —Å–µ—Ç—å—é?**

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ç–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º:

*   **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö:** –ù–æ–≤–æ—Å—Ç–∏, —Å–ø–∏—Å–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤, –ø–æ–≥–æ–¥–∞, –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç, –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç.–¥.
*   **–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –∏ —Ç.–¥.
*   **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å API:** –û–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É HTTP (REST API, GraphQL –∏ —Ç.–¥.).

## **1.2. –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

*   **Retrofit:**  –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å REST API. Retrofit –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø–∏—Å–∞—Ç—å API —Å –ø–æ–º–æ—â—å—é –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ Kotlin, –∞ –∑–∞—Ç–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
*   **Moshi/Gson:**  –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è JSON-—Å—Ç—Ä–æ–∫–∏ –≤ –æ–±—ä–µ–∫—Ç—ã Kotlin –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç). Moshi ‚Äì –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Square (—Å–æ–∑–¥–∞—Ç–µ–ª–µ–π Retrofit), Gson ‚Äì –±–æ–ª–µ–µ —Å—Ç–∞—Ä–∞—è, –Ω–æ —Ç–æ–∂–µ –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Google. –í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Moshi.
*   **OkHttp:**  HTTP-–∫–ª–∏–µ–Ω—Ç –æ—Ç Square, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Retrofit "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º".  –û–±—ã—á–Ω–æ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å OkHttp –Ω–∞–ø—Ä—è–º—É—é, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –æ–Ω –µ—Å—Ç—å.
*   **–ö–æ—Ä—É—Ç–∏–Ω—ã (Coroutines):**  –ú–µ—Ö–∞–Ω–∏–∑–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –≤ Kotlin. –ö–æ—Ä—É—Ç–∏–Ω—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–∏—Å–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã) —Ç–∞–∫ –∂–µ –ø—Ä–æ—Å—Ç–æ, –∫–∞–∫ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π.


**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (build.gradle.kts (Module :app)):**

```kotlin
dependencies {
    // ... –¥—Ä—É–≥–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ...

  
    // Retrofit  
	implementation(libs.retrofit)  
	implementation(libs.converter.moshi)  
	implementation(libs.moshi.kotlin)  
	ksp(libs.moshi.kotlin.codegen)  
	implementation(libs.okhttp)  
	implementation(libs.logging.interceptor)
    
    // Moshi
	implementation(libs.moshi)
	implementation(libs.converter.moshi) // Moshi Converter for Retrofit  
	ksp(libs.moshi.kotlin.codegen) //–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–¥–∞
  
// Gson (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Moshi, –µ—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω—É–∂–µ–Ω –∏–º–µ–Ω–Ω–æ Gson)  
	 implementation(libs.gson)  
	 implementation(libs.converter.gson)
   // Coroutines  
	implementation(libs.kotlinx.coroutines.android)  
	implementation(libs.kotlinx.coroutines.core)

}
```
–ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –¥–æ—Å—Ç—É–ø –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤ `AndroidManifest.xml`

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    ...>

    <uses-permission android:name="android.permission.INTERNET" />

    <application
        ...
    </application>

</manifest>
```
 –û–ø–∏—Å–∞–Ω–∏–µ API —Å –ø–æ–º–æ—â—å—é Retrofit**

–í Retrofit API –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ Kotlin.  –ö–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É endpoint'—É API.  –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ Retrofit —É–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫–æ–π HTTP-–º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (GET, POST, PUT, DELETE –∏ —Ç.–¥.), URL endpoint'–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞, –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ç.–¥.

**–ü—Ä–∏–º–µ—Ä (–∏—Å–ø–æ–ª—å–∑—É–µ–º API JSONPlaceholder –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**

```kotlin
// ApiService.kt
import retrofit2.Response
import retrofit2.http.GET
import retrofit2.http.Path
import retrofit2.http.Query

// –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (data class) –¥–ª—è –ø–æ—Å—Ç–∞
data class Post(
    val userId: Int,
    val id: Int,
    val title: String,
    val body: String
)

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è API
interface ApiService {
    @GET("posts")
    suspend fun getPosts(): Response<List<Post>> //–í—Å–µ –ø–æ—Å—Ç—ã

    @GET("posts/{id}")
    suspend fun getPostById(@Path("id") postId: Int): Response<Post> //–ü–æ—Å—Ç –ø–æ ID

    @GET("posts")
    suspend fun getPostsByUserId(@Query("userId") userId: Int): Response<List<Post>> //–ü–æ—Å—Ç—ã –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
}
```

*   **`data class Post(...)`:**  –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å –¥–∞–Ω–Ω—ã—Ö `Post` –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ—Å—Ç–∞.  –ü–æ–ª—è –∫–ª–∞—Å—Å–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–ª—è–º –≤ JSON-–æ—Ç–≤–µ—Ç–µ.
*   **`interface ApiService`:**  –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ApiService`.
    *   **`@GET("posts")`:**  –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –º–µ—Ç–æ–¥ `getPosts` –≤—ã–ø–æ–ª–Ω—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –∫ `/posts`.
        *   **`suspend fun getPosts(): Response<List<Post>>`:**  –ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ (`List<Post>`).  –ò—Å–ø–æ–ª—å–∑—É–µ–º `suspend`, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∫–æ—Ä—É—Ç–∏–Ω–µ). `Response` ‚Äì —ç—Ç–æ –æ–±–µ—Ä—Ç–∫–∞ Retrofit, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—Ç–≤–µ—Ç–µ (—É—Å–ø–µ—à–Ω—ã–π/–Ω–µ—É—Å–ø–µ—à–Ω—ã–π, –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞, –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ç.–¥.).
    *   **`@GET("posts/{id}")`:**  GET-–∑–∞–ø—Ä–æ—Å –∫ `/posts/{id}` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/posts/1`).
        *   **`@Path("id") postId: Int`:**  –ü–∞—Ä–∞–º–µ—Ç—Ä `postId` –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ URL –≤–º–µ—Å—Ç–æ `{id}`.
    *   **`@GET("posts")`:**  GET-–∑–∞–ø—Ä–æ—Å –∫ `/posts`.
        *   **`@Query("userId") userId: Int`:**  –î–æ–±–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞–ø—Ä–æ—Å–∞ `userId` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/posts?userId=1`).


**–°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ Retrofit

```kotlin
import com.squareup.moshi.Moshi
import com.squareup.moshi.kotlin.reflect.KotlinJsonAdapterFactory
import okhttp3.OkHttpClient
import okhttp3.logging.HttpLoggingInterceptor
import retrofit2.Retrofit
import retrofit2.converter.moshi.MoshiConverterFactory

object RetrofitInstance {

  private val moshi = Moshi.Builder()
      .add(KotlinJsonAdapterFactory()) // –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Kotlin data class
      .build()

    //OkHttpClient –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è header, interceptor(–Ω–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –ª–æ–≥–æ–≤)
  private val okHttpClient = OkHttpClient.Builder()
        .addInterceptor(HttpLoggingInterceptor().apply {
          level = HttpLoggingInterceptor.Level.BODY // –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (BODY - –ª–æ–≥–∏—Ä—É–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—Ç–∞)
        })
        .build()

  val api: ApiService by lazy { // –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      Retrofit.Builder()
          .baseUrl("https://jsonplaceholder.typicode.com/") // –ë–∞–∑–æ–≤—ã–π URL
          .client(okHttpClient) // –ò—Å–ø–æ–ª—å–∑—É–µ–º OkHttpClient
          .addConverterFactory(MoshiConverterFactory.create(moshi)) // –ò—Å–ø–æ–ª—å–∑—É–µ–º Moshi
          //.addConverterFactory(GsonConverterFactory.create()) // –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º Gson
          .build()
          .create(ApiService::class.java) // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä ApiService
  }
}

```
* **`Moshi.Builder()...build()`:** –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä Moshi (–¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON). –î–æ–±–∞–≤–ª—è–µ–º `KotlinJsonAdapterFactory` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Kotlin data classes.
* **`OkHttpClient.Builder()...build()`:** –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä OkHttpClient.
    *   **`addInterceptor(HttpLoggingInterceptor())`:**  –î–æ–±–∞–≤–ª—è–µ–º *interceptor* –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏).  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è `BODY` (–ª–æ–≥–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞/–æ—Ç–≤–µ—Ç–∞).
*   **`Retrofit.Builder()...build()`:**  –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä Retrofit.
    *   **`baseUrl("https://jsonplaceholder.typicode.com/")`:**  –£–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—ã–π URL API.
    *   **`client(okHttpClient)`:** –ü–µ—Ä–µ–¥–∞–µ–º OkHttpClient.
    *   **`addConverterFactory(MoshiConverterFactory.create(moshi))`:**  –î–æ–±–∞–≤–ª—è–µ–º *converter factory* –¥–ª—è Moshi, —á—Ç–æ–±—ã Retrofit –º–æ–≥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å JSON –≤ –æ–±—ä–µ–∫—Ç—ã Kotlin –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.  –ï—Å–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Gson, —Ç–æ –¥–æ–±–∞–≤–∏–ª–∏ –±—ã `GsonConverterFactory.create()`.
    *   **`build()`:**  –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä `Retrofit`.
    * **`.create(ApiService::class.java)`:** –°–æ–∑–¥–∞–µ–º –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—é –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `ApiService`.


–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ ViewModel**

–õ—É—á—à–µ –≤—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ `ViewModel`, –∞ –Ω–µ –≤ composable-—Ñ—É–Ω–∫—Ü–∏—è—Ö.  `ViewModel` –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–≤–æ—Ä–æ—Ç —ç–∫—Ä–∞–Ω–∞), –∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.

```kotlin
// MainViewModel.kt
import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import kotlinx.coroutines.launch
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.getValue
import androidx.compose.runtime.setValue
import kotlinx.coroutines.Dispatchers
import java.lang.Exception

class MainViewModel : ViewModel() {

    var posts by mutableStateOf<List<Post>>(emptyList())
        private set // –ó–∞–ø–∏—Å—å —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ ViewModel

    var isLoading by mutableStateOf(false)
        private set

    var errorMessage by mutableStateOf<String?>(null)
        private set


    fun getPosts() {
        viewModelScope.launch(Dispatchers.IO) { // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ—Ä—É—Ç–∏–Ω—É –≤ IO-–¥–∏—Å–ø–µ—Ç—á–µ—Ä–µ (–¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
            isLoading = true //–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
            errorMessage = null //–°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
            try {
                val response = RetrofitInstance.api.getPosts()
                if (response.isSuccessful) {
                    posts = response.body() ?: emptyList() // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤
                } else {
                    errorMessage = "Error: ${response.code()}" // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–¥ –æ—à–∏–±–∫–∏
                }
            } catch (e: Exception) {
                errorMessage = "Error: ${e.message}" // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
            }
            finally {
              isLoading = false // –°–∫—Ä—ã–≤–∞–µ–º ProgressBar
            }
        }
    }

    fun getPostById(id: Int){
      viewModelScope.launch(Dispatchers.IO) {
        try {
          val response = RetrofitInstance.api.getPostById(id)
          //...
        } catch (e: Exception){
          //...
        }
      }
    }
}
```

*   **`class MainViewModel : ViewModel()`:**  –°–æ–∑–¥–∞–µ–º `ViewModel`.
*   **`var posts by mutableStateOf<List<Post>>(emptyList()) private set`:**  –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤. `private set` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∏–∑–º–µ–Ω—è—Ç—å —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ `ViewModel`.
*   **`var isLoading by mutableStateOf(false) private set`:** –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏.
*   **`var errorMessage by mutableStateOf<String?>(null) private set`:** –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ.
*   **`fun getPosts() { ... }`:**  –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤.
    *   **`viewModelScope.launch(Dispatchers.IO) { ... }`:**  –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ—Ä—É—Ç–∏–Ω—É –≤ `viewModelScope`.  `viewModelScope` ‚Äì —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π scope, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∂–∏–∑–Ω–µ–Ω–Ω–æ–º—É —Ü–∏–∫–ª—É `ViewModel`.  –ö–æ–≥–¥–∞ `ViewModel` —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è, –≤—Å–µ –∫–æ—Ä—É—Ç–∏–Ω—ã, –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –≤ `viewModelScope`, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è. `Dispatchers.IO` ‚Äì —ç—Ç–æ –¥–∏—Å–ø–µ—Ç—á–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ (—Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ –∏ —Ç.–¥.).
    *   **`isLoading = true`:**  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º `isLoading` –≤ `true` (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏).
    *   **`errorMessage = null`:** –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É.
    *   **`try { ... } catch (e: Exception) { ... } finally { ... }`:**  –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏.
        *   **`val response = RetrofitInstance.api.getPosts()`:**  –í—ã–ø–æ–ª–Ω—è–µ–º —Å–µ—Ç–µ–≤–æ–π –∑–∞–ø—Ä–æ—Å —Å –ø–æ–º–æ—â—å—é Retrofit.
        *   **`if (response.isSuccessful) { ... } else { ... }`:**  –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω—ã–º.
            *   **`posts = response.body() ?: emptyList()`:**  –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω—ã–π, –ø–æ–ª—É—á–∞–µ–º —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ (`response.body()`) –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ `posts`. –ï—Å–ª–∏ `response.body()` —Ä–∞–≤–Ω–æ `null` (—Ç–∞–∫–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç), –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ (`emptyList()`).
        *   **`catch (e: Exception) { ... }`:**  –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—É), —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.
        *   **`finally { isLoading = false }`:** –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞) —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏.

–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ UI**

```kotlin
// MainActivity.kt
import android.os.Bundle
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.items
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.unit.dp
import androidx.lifecycle.viewmodel.compose.viewModel 
import com.example.networkexample.ui.theme.NetworkExampleTheme 

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent {
            NetworkExampleTheme {  
                Surface(
                    modifier = Modifier.fillMaxSize(),
                    color = MaterialTheme.colorScheme.background
                ) {
                    PostListScreen()
                }
            }
        }
    }
}

@Composable
fun PostListScreen(viewModel: MainViewModel = viewModel()) {

    // –í—ã–∑—ã–≤–∞–µ–º getPosts() –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —ç–∫—Ä–∞–Ω–∞
    LaunchedEffect(key1 = true) {
        viewModel.getPosts()
    }

    Column(
        modifier = Modifier
            .fillMaxSize()
            .padding(16.dp)
    ) {
        if (viewModel.isLoading) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            CircularProgressIndicator(modifier = Modifier.align(Alignment.CenterHorizontally))
        } else if (viewModel.errorMessage != null) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            Text(
                text = "Error: ${viewModel.errorMessage}",
                color = MaterialTheme.colorScheme.error
            )
        } else {
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤
            LazyColumn {
                items(viewModel.posts) { post ->
                    PostItem(post = post)
                }
            }
        }
    }
}

@Composable
fun PostItem(post: Post) {
    Card(
      modifier = Modifier
        .fillMaxWidth()
        .padding(vertical = 8.dp),
      elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
    ) {
        Column(
          modifier = Modifier.padding(16.dp)
        ) {
            Text(text = post.title, style = MaterialTheme.typography.titleMedium)
            Spacer(modifier = Modifier.height(4.dp))
            Text(text = post.body, style = MaterialTheme.typography.bodyMedium)
        }
    }
}
```

*   **`PostListScreen(viewModel: MainViewModel = viewModel())`:**
    *   –ü—Ä–∏–Ω–∏–º–∞–µ–º `MainViewModel` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.  –ò—Å–ø–æ–ª—å–∑—É–µ–º `viewModel()` (–∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `androidx.lifecycle.viewmodel.compose`), —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä `ViewModel`.
*   **`LaunchedEffect(key1 = true) { viewModel.getPosts() }`:**  –ò—Å–ø–æ–ª—å–∑—É–µ–º `LaunchedEffect` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —ç–∫—Ä–∞–Ω–∞ (–∏–ª–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `key1`). –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –≤—ã–∑—ã–≤–∞–µ–º `viewModel.getPosts()` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —ç–∫—Ä–∞–Ω–∞, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤.
*   **`if (viewModel.isLoading) { ... } else if (viewModel.errorMessage != null) { ... } else { ... }`:**  –û—Ç–æ–±—Ä–∞–∂–∞–µ–º UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è `ViewModel`.
    *   –ï—Å–ª–∏ `isLoading == true`, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º `CircularProgressIndicator`.
    *   –ï—Å–ª–∏ `errorMessage != null`, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.
    *   –ò–Ω–∞—á–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é `LazyColumn`.
* **`PostItem(...)`:** Composable —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ—Å—Ç–∞.
## 2üì±   –í–≤–µ–¥–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö API

* **API (Application Programming Interface)** ‚Äì —ç—Ç–æ –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –ø–æ–∑–≤–æ–ª—è—é—â–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –æ–±—â–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö API –¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∞—à–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–≥–æ–¥–µ, –Ω–æ–≤–æ—Å—Ç—è—Ö, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ —Ç.–¥.) –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

* **–¶–µ–ª—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ API:**

* **–ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏:**
  
  * **–í—ã–±–æ—Ä API**: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –∫–∞–∫–æ–π API –≤–∞–º –Ω—É–∂–µ–Ω –¥–ª—è –≤–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–≥–æ–¥–∞, –ø–µ—Ä–µ–≤–æ–¥, –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è).
  
  * **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ú–Ω–æ–≥–∏–µ API —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∫–ª—é—á–∏ API –∏–ª–∏ —Ç–æ–∫–µ–Ω—ã.
  
  * **–°–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤, —Ç–∞–∫–∏–µ –∫–∞–∫ Retrofit –∏–ª–∏ OkHttp.
  
  * **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:** –ü–∞—Ä—Å–∏–Ω–≥ JSON –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, Gson.
  
  * **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI:** –†–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Coroutines –∏–ª–∏ Flow.

### 2.1 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–Ω–µ—à–Ω–∏—Ö API –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* **–†–∞—Å—à–∏—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.** –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ, –Ω–æ–≤–æ—Å—Ç—è—Ö –∏–ª–∏ –∫—É—Ä—Å–∞—Ö –≤–∞–ª—é—Ç.
* **–û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.** –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏–ª–∏ –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
* **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è.** –ù–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –∫–∞—Ä—Ç—ã –∏–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏.

### 2.2 –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã API

* **–ó–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã.** –û–±—ã—á–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É HTTP/HTTPS, –≥–¥–µ –∑–∞–ø—Ä–æ—Å—ã (GET, POST, PUT, DELETE –∏ –¥—Ä.) –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∞ –æ—Ç–≤–µ—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –∏–ª–∏ XML.

* **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.** –ö–∞–∂–¥–æ–µ API —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–ø–∏—Å–∞–Ω—ã –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç—ã, –∫–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

* **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.** –ú–Ω–æ–≥–∏–µ API —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤, API-–∫–ª—é—á–µ–π –∏–ª–∏ OAuth –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.

* **–†–∞–±–æ—Ç–∞ —Å —Å–µ—Ç—å—é** ‚Äì —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —É–¥–∞–ª—ë–Ω–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–∞–º, –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –æ–±–º–µ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –º–µ–∂–¥—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

* **–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å —Å–µ—Ç—å—é?**
  
  * –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–æ–≤–æ—Å—Ç–∏, –ø–æ–≥–æ–¥–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö –∏ —Ç.–¥.).
  * –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º).
  * –†–∞—Å—à–∏—Ä—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞ —Å—á—ë—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ API.
* **–û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é:**

### 3.1 Retrofit

Retrofit ‚Äì —ç—Ç–æ –º–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Square –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ REST API-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö. –û–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç JSON-–æ—Ç–≤–µ—Ç—ã –≤ –æ–±—ä–µ–∫—Ç—ã Java/Kotlin, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Gson –∏–ª–∏ Moshi).

* –ü—Ä–æ—Å—Ç–æ—Ç–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ Kotlin Coroutines –∏–ª–∏ RxJava.
* –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫.

### 3.2 OkHttp

OkHttp ‚Äì —ç—Ç–æ HTTP –∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å Retrofit. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∫—É HTTP/2, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ interceptors –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤.

### 3.3 Gson –∏ Moshi

–≠—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ JSON-–¥–∞–Ω–Ω—ã—Ö:

* **Gson** ‚Äì –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Google, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å JSON –≤ –æ–±—ä–µ–∫—Ç—ã –∏ –æ–±—Ä–∞—Ç–Ω–æ.
* **Moshi** ‚Äì –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç Square, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π Kotlin –∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é—â–∏–π –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–æ–≤.

![apiintegreation.png](..\apiintegreation.png)

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. REST API

* –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç HTTP –º–µ—Ç–æ–¥—ã (GET, POST, PUT, DELETE)
* –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
* –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è

### 2. HTTP –º–µ—Ç–æ–¥—ã

* GET - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
* POST - —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
* PUT/PATCH - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
* DELETE - —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üõ† –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (build.gradle)

–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `build.gradle` –º–æ–¥—É–ª—è —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

````kotlin
dependencies { 
implementation (libs.retrofit)  
implementation (libs.converter.gson)  
implementation (libs.logging.interceptor)  
implementation (libs.kotlinx.coroutines.android)
}

````

### 1. Retrofit

````kotlin
// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ API –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
interface WeatherApi {
    @GET("weather")
    suspend fun getWeather(
        @Query("city") city: String,
        @Query("apiKey") apiKey: String
    ): WeatherResponse
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Retrofit
object RetrofitClient {
    private const val BASE_URL = "https://api.weather.com/"
    
    private val retrofit = Retrofit.Builder()
        .baseUrl(BASE_URL)
        .addConverterFactory(GsonConverterFactory.create())
        .client(createOkHttpClient())
        .build()
    
    val weatherApi: WeatherApi = retrofit.create(WeatherApi::class.java)
    
    private fun createOkHttpClient(): OkHttpClient {
        return OkHttpClient.Builder()
            .addInterceptor(HttpLoggingInterceptor().apply {
                level = HttpLoggingInterceptor.Level.BODY
            })
            .build()
    }
}
````

### 2. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

````kotlin
data class WeatherResponse(
    val temperature: Double,
    val description: String,
    val humidity: Int,
    val windSpeed: Double
)

data class ErrorResponse(
    val code: Int,
    val message: String
)
````

### 3. Repository

````kotlin
class WeatherRepository(
    private val api: WeatherApi,
    private val dispatcher: CoroutineDispatcher = Dispatchers.IO
) {
    suspend fun getWeather(city: String): Result<WeatherResponse> {
        return withContext(dispatcher) {
            try {
                val response = api.getWeather(
                    city = city,
                    apiKey = BuildConfig.WEATHER_API_KEY
                )
                Result.success(response)
            } catch (e: Exception) {
                Result.failure(e)
            }
        }
    }
}
````

### 4. ViewModel

````kotlin
class WeatherViewModel(
    private val repository: WeatherRepository
) : ViewModel() {
    private val _weatherState = MutableStateFlow<WeatherUiState>(WeatherUiState.Initial)
    val weatherState = _weatherState.asStateFlow()
    
    fun getWeather(city: String) {
        viewModelScope.launch {
            _weatherState.value = WeatherUiState.Loading
            
            repository.getWeather(city)
                .onSuccess { weather ->
                    _weatherState.value = WeatherUiState.Success(weather)
                }
                .onFailure { error ->
                    _weatherState.value = WeatherUiState.Error(error.message)
                }
        }
    }
}

sealed class WeatherUiState {
    object Initial : WeatherUiState()
    object Loading : WeatherUiState()
    data class Success(val weather: WeatherResponse) : WeatherUiState()
    data class Error(val message: String?) : WeatherUiState()
}
````

### 5. UI

````kotlin
@Composable
fun WeatherScreen(
    viewModel: WeatherViewModel = viewModel()
) {
    val state by viewModel.weatherState.collectAsState()
    var city by remember { mutableStateOf("") }
    
    Column(
        modifier = Modifier
            .fillMaxSize()
            .padding(16.dp)
    ) {
        OutlinedTextField(
            value = city,
            onValueChange = { city = it },
            label = { Text("–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥") },
            modifier = Modifier.fillMaxWidth()
        )
        
        Spacer(modifier = Modifier.height(8.dp))
        
        Button(
            onClick = { viewModel.getWeather(city) },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("–ü–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É")
        }
        
        Spacer(modifier = Modifier.height(16.dp))
        
        when (state) {
            is WeatherUiState.Loading -> {
                CircularProgressIndicator()
            }
            is WeatherUiState.Success -> {
                val weather = (state as WeatherUiState.Success).weather
                WeatherInfo(weather)
            }
            is WeatherUiState.Error -> {
                Text(
                    text = (state as WeatherUiState.Error).message ?: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞",
                    color = MaterialTheme.colorScheme.error
                )
            }
            else -> Unit
        }
    }
}
````

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS
* –•—Ä–∞–Ω–∏—Ç–µ API –∫–ª—é—á–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ
* –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

* –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤
* –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏
* –ò–Ω—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
* –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã
* –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Ä–∞–∑–º–µ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

* [Retrofit Documentation](https://square.github.io/retrofit/)
* [Android Network Guide](https://developer.android.com/training/basics/network-ops/connecting)
* [RapidAPI Hub](https://rapidapi.com/hub)
* [–ü—Ä–∞–∫—Ç–∏–∫—É–º –ø–æ Retrofit](https://practicum.yandex.ru/blog/retrofit-na-android/)

## üì±–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ API

https://rapidapi.com/hub
https://community.exolve.ru/blog/10-api-for-developers-for-everyday/

## üé• –í–∏–¥–µ–æ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

[![Watch the video](https://img.youtube.com/vi/jgfB7lgD6Kk/0.jpg)](https://www.youtube.com/watch?v=jgfB7lgD6Kk&pp=ygUbYW5kcm9pZCDQodC10YLRjCDQsiBBbmRyb2lk)
[![Watch the video](https://img.youtube.com/vi/dqUTX6hR9Mk/0.jpg)](https://www.youtube.com/watch?v=dqUTX6hR9Mk&t=74s&pp=ygUgYW5kcm9pZCBhcGkgaW50ZWdyYXRpb24gdHV0b3JpYWw%3D)
[![Watch the video](https://img.youtube.com/vi/ByGJQzlzxQg/0.jpg)](https://www.youtube.com/watch?v=ByGJQzlzxQg&pp=ygUgYW5kcm9pZCBhcGkgaW50ZWdyYXRpb24gdHV0b3JpYWw%3D)

[![Watch the video](https://img.youtube.com/vi/Kn6vUH1uJT4/0.jpg)](https://www.youtube.com/watch?v=Kn6vUH1uJT4&pp=ygUgYW5kcm9pZCBhcGkgaW50ZWdyYXRpb24gdHV0b3JpYWw%3D)
